<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Coach Chris CRC</title>
    
    <!-- PWA Meta Tags -->
    <meta name="theme-color" content="#fcfcfc">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <meta name="apple-mobile-web-app-title" content="CoachChrisCRC">
    
    <!-- App Icons -->
    <link rel="apple-touch-icon" href="https://raw.githubusercontent.com/CoachChrisCRC/app/df3580c5a17d646dc6813a283f7e85e269fece8e/CoachChrisCRC-AppIcon.png">
    
    <!-- Robust Manifest Data URI -->
    <link rel="manifest" href="data:application/manifest+json,{%22name%22:%22CoachChrisCRC%20Business%20Card%22,%22short_name%22:%22CoachChrisCRC%22,%22description%22:%22Professional%20Training%20Hub%20by%20Coach%20Chris%22,%22start_url%22:%22./%22,%22scope%22:%22./%22,%22display%22:%22standalone%22,%22orientation%22:%22portrait%22,%22background_color%22:%22%23ffffff%22,%22theme_color%22:%22%23ffffff%22,%22icons%22:[{%22src%22:%22https://raw.githubusercontent.com/CoachChrisCRC/app/df3580c5a17d646dc6813a283f7e85e269fece8e/CoachChrisCRC-AppIcon.png%22,%22sizes%22:%22512x512%22,%22type%22:%22image/png%22,%22purpose%22:%22any%20maskable%22}]} " />

    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:ital,wght@0,400;0,700;0,900;1,400;1,700&family=Rock+Salt&display=swap');
        :root { --olive: #808a5c; --bg: #f2f2f2; }
        
        body { 
            font-family: 'Inter', sans-serif; 
            background-color: var(--bg); 
            background-image: radial-gradient(circle at 50% 50%, #ffffff 0%, #f2f2f2 100%);
            color: #000; 
            overflow: hidden; 
            margin: 0; 
            display: flex; 
            align-items: center; 
            justify-content: center; 
            min-height: 100svh;
        }

        .rock-salt { font-family: 'Rock Salt', cursive; }

        /* Splash Screen */
        #splash-screen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: #0a0a0a;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            z-index: 9999;
            transition: opacity 0.6s cubic-bezier(0.65, 0, 0.35, 1), visibility 0.6s;
        }
        #splash-screen.fade-out { opacity: 0; visibility: hidden; }

        /* Transition Screen */
        #transition-screen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: #ffffff;
            display: none;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            z-index: 9998;
            opacity: 0;
            transition: opacity 0.3s ease;
        }
        #transition-screen.active { display: flex; opacity: 1; }

        .card-perspective {
            perspective: 1500px;
            width: 90%;
            max-width: 380px;
        }

        .card-container {
            background: rgba(255, 255, 255, 0.85);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            border-radius: 48px;
            padding: 40px 24px 40px 24px;
            box-shadow: 
                0 40px 80px -20px rgba(0, 0, 0, 0.15),
                0 0 0 1px rgba(255, 255, 255, 0.5) inset;
            border: 1px solid rgba(0, 0, 0, 0.05);
            display: flex;
            flex-direction: column;
            align-items: center;
            text-align: center;
            position: relative;
            transform-style: preserve-3d;
        }

        .card-container::before {
            content: '';
            position: absolute;
            inset: -2px;
            background: linear-gradient(135deg, #ffffff, #e2e2e2, #808a5c, #ffffff);
            z-index: -1;
            border-radius: 50px;
            opacity: 0.3;
        }

        .avatar-ring { 
            position: relative; 
            padding: 8px; 
            background: white; 
            border-radius: 50%; 
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            margin-bottom: 20px; 
            perspective: 1000px;
        }
        .avatar-flipper { width: 130px; height: 130px; position: relative; transform-style: preserve-3d; transition: transform 0.8s cubic-bezier(0.34, 1.56, 0.64, 1); }
        .avatar-flipper img { width: 100%; height: 100%; border-radius: 50%; object-fit: cover; position: absolute; backface-visibility: hidden; border: 4px solid #fff; }

        /* Swipe UI */
        .swipe-track { 
            position: relative; 
            width: 100%; 
            height: 68px; 
            background: #ffffff; 
            border-radius: 99px; 
            display: flex; 
            align-items: center; 
            justify-content: center; 
            overflow: hidden; 
            box-shadow: inset 0 2px 8px rgba(0,0,0,0.05);
            border: 1px solid rgba(0,0,0,0.05);
        }
        .swipe-handle { 
            position: absolute; 
            left: 6px; 
            width: 56px; 
            height: 56px; 
            background: var(--olive); 
            border-radius: 50%; 
            display: flex; 
            align-items: center; 
            justify-content: center; 
            color: white; 
            cursor: grab; 
            z-index: 2; 
            box-shadow: 0 4px 15px rgba(128, 138, 92, 0.4); 
            touch-action: none; 
        }
        .swipe-text { font-size: 10px; font-weight: 800; text-transform: uppercase; letter-spacing: 0.15em; color: #a1a1aa; pointer-events: none; }

        /* QR Overlay */
        #qr-modal { display: none; position: fixed; inset: 0; background: rgba(0,0,0,0.9); backdrop-filter: blur(15px); z-index: 9500; align-items: center; justify-content: center; padding: 24px; opacity: 0; transition: opacity 0.3s ease; }
        #qr-modal.active { display: flex; opacity: 1; }
        .modal-content { background: white; border-radius: 40px; width: 100%; max-width: 380px; padding: 40px 24px; transform: scale(0.9); transition: transform 0.4s cubic-bezier(0.34, 1.56, 0.64, 1); }
        #qr-modal.active .modal-content { transform: scale(1); }
        
        .qr-logo-overlay { position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); width: 90px; height: 90px; background: white; padding: 6px; border-radius: 20px; box-shadow: 0 10px 20px rgba(0,0,0,0.1); }
        .qr-logo-overlay img { width: 100%; height: 100%; border-radius: 14px; object-fit: cover; }

        /* Floating Action Button */
        .fab-container {
            position: fixed;
            top: 30px;
            right: 30px;
            display: none;
            align-items: center;
            gap: 10px;
            z-index: 9000;
        }
        .fab {
            width: 60px;
            height: 60px;
            background: #ffffff;
            color: #18181b;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 10px 25px rgba(0,0,0,0.2);
            cursor: pointer;
            transition: all 0.3s ease;
            border: 2px solid #808a5c;
        }

        /* EKG Splash */
        .ekg-path { stroke: var(--olive); stroke-width: 2; fill: none; stroke-dasharray: 500; stroke-dashoffset: 500; animation: ekg-draw 2s linear infinite; }
        @keyframes ekg-draw { 0% { stroke-dashoffset: 500; opacity: 0; } 10% { opacity: 1; } 90% { opacity: 1; } 100% { stroke-dashoffset: 0; opacity: 0; } }
    </style>
</head>
<body>

    <!-- Splash Screen -->
    <div id="splash-screen">
        <div class="flex flex-col items-center px-4">
            <div class="flex items-center justify-center gap-4 mb-10">
                <div class="w-16 h-16 rounded-full overflow-hidden bg-white/10 p-1 border border-white/20">
                    <img src="https://raw.githubusercontent.com/CoachChrisCRC/linkscard/refs/heads/main/UNCNVNTNL-Logo.png" class="w-full h-full object-contain">
                </div>
                <div class="relative w-36 h-36 rounded-full border-4 border-[#808a5c] overflow-hidden shadow-[0_0_40px_rgba(128,138,92,0.4)]">
                    <img src="https://raw.githubusercontent.com/CoachChrisCRC/app/df3580c5a17d646dc6813a283f7e85e269fece8e/CoachChrisCRC-AppIcon.png" class="w-full h-full object-cover">
                </div>
                <div class="w-16 h-16 rounded-full overflow-hidden bg-white/10 p-1 border border-white/20">
                    <img src="https://raw.githubusercontent.com/CoachChrisCRC/linkscard/refs/heads/main/CRC-Logo.png" class="w-full h-full object-contain">
                </div>
            </div>
            <h1 class="text-white text-xl font-black uppercase tracking-[0.3em] mb-4">Coach Chris <span class="text-[#808a5c]">CRC</span></h1>
            <div class="w-48 h-10 relative overflow-hidden">
                <svg class="w-full h-full" viewBox="0 0 180 40">
                    <path class="ekg-path" d="M0,20 L40,20 L45,10 L55,30 L60,20 L90,20 L95,0 L105,40 L110,20 L180,20"></path>
                </svg>
            </div>
        </div>
    </div>

    <!-- Transition Screen -->
    <div id="transition-screen">
        <div class="flex flex-col items-center">
            <div class="w-16 h-16 bg-[#808a5c] rounded-full animate-ping opacity-25"></div>
            <p class="text-[10px] font-black uppercase tracking-[0.3em] text-zinc-400 mt-8">Redirecting...</p>
        </div>
    </div>

    <!-- QR Modal -->
    <div id="qr-modal">
        <div class="modal-content text-center">
            <h2 class="rock-salt font-bold text-xl text-zinc-800 uppercase tracking-tight mb-8">COACH CHRIS</h2>
            <div id="qrcode-wrapper" class="relative inline-block mb-8">
                <div id="qrcode"></div>
                <div class="qr-logo-overlay">
                    <img src="https://raw.githubusercontent.com/CoachChrisCRC/app/df3580c5a17d646dc6813a283f7e85e269fece8e/CoachChrisCRC-AppIcon.png">
                </div>
            </div>
            <div class="flex flex-col items-center mb-8">
                <h3 class="text-black font-black text-2xl uppercase tracking-tight mb-1">Chris Hedley</h3>
                <p class="text-zinc-500 text-xs font-bold uppercase tracking-widest mb-4">Online Coach & PT</p>
                <div class="flex flex-col gap-1 text-[10px] font-black uppercase tracking-[0.2em] text-zinc-400 mb-6 italic">
                    <span>Circular Roots Coaching</span>
                    <span>TRAIN UNCNVNTNL</span>
                </div>
                <p class="text-[#808a5c] text-xs font-black uppercase tracking-[0.3em]">#FITTER #STRONGER #BETTER</p>
            </div>
            <button id="close-qr" class="w-full bg-zinc-900 text-white py-5 rounded-2xl text-xs font-black uppercase tracking-widest active:scale-95 transition-transform">Dismiss</button>
        </div>
    </div>

    <!-- Floating Install Button -->
    <div class="fab-container" id="save-ui-container">
        <div class="fab" id="fab-save" title="Install App">
            <i data-lucide="download" class="w-6 h-6"></i>
        </div>
    </div>

    <!-- Main Card -->
    <div class="card-perspective">
        <div id="main-card" class="card-container opacity-0 translate-y-12 transition-all duration-1000 ease-out">
            <div class="avatar-ring">
                <div class="avatar-flipper" id="avatar-flipper">
                    <img id="avatar-front" src="https://raw.githubusercontent.com/CoachChrisCRC/linkscard/refs/heads/main/CRC-Logo.png" alt="Logo Front">
                    <img id="avatar-back" src="https://raw.githubusercontent.com/CoachChrisCRC/linkscard/refs/heads/main/UNCNVNTNL-Logo.png" alt="Logo Back" style="transform: rotateY(180deg);">
                </div>
            </div>

            <h2 class="rock-salt font-bold text-2xl text-zinc-800 uppercase tracking-tight mb-3">COACH CHRIS</h2>
            <h3 class="text-black font-black text-2xl uppercase tracking-tighter mb-1">Chris Hedley</h3>
            <p class="text-zinc-500 text-[10px] font-bold uppercase tracking-[0.25em] mb-4">Online Coach & PT</p>
            
            <div class="flex flex-col gap-1 text-[10px] font-black uppercase tracking-[0.2em] text-zinc-700 mb-8 italic">
                <span>Circular Roots Coaching</span>
                <span>TRAIN UNCNVNTNL</span>
            </div>

            <div class="flex flex-col w-full gap-4">
                <div class="flex gap-3 w-full">
                    <button id="open-qr" class="flex-1 flex items-center justify-center gap-2 bg-zinc-900 text-white py-4 rounded-2xl shadow-md active:scale-[0.96] transition-all">
                        <i data-lucide="qr-code" class="w-4 h-4"></i>
                        <span class="text-[9px] font-black uppercase tracking-widest">Share Card</span>
                    </button>
                    <button id="save-vcard" class="flex-1 flex items-center justify-center gap-2 border-2 border-zinc-900 text-zinc-900 py-4 rounded-2xl shadow-sm active:scale-[0.96] transition-all">
                        <i data-lucide="user-plus" class="w-4 h-4"></i>
                        <span class="text-[9px] font-black uppercase tracking-widest">Save Contact</span>
                    </button>
                </div>

                <div class="swipe-track">
                    <div class="swipe-handle" id="swipe-handle">
                        <i data-lucide="chevron-right" class="w-6 h-6"></i>
                    </div>
                    <span class="swipe-text" id="swipe-text">Swipe to Explore</span>
                </div>
            </div>

            <div class="mt-8 pt-6 border-t border-zinc-100 w-full">
                <p class="text-[#808a5c] text-[8px] font-black uppercase tracking-[0.4em]">#FITTER #STRONGER #BETTER</p>
            </div>
        </div>
    </div>

    <script>
        const EXTERNAL_URL = "https://coachchriscrc.carrd.co";
        const CONTACT_INFO = {
            name: "Coach Chris (Chris Hedley)",
            phone: "447925116794",
            email: "Circularrootscoaching@gmail.com",
            web: "https://coachchriscrc.carrd.co",
            instagram: "chris.h_crc"
        };
        const LOGOS = [
            "https://raw.githubusercontent.com/CoachChrisCRC/linkscard/refs/heads/main/CRC-Logo.png",
            "https://raw.githubusercontent.com/CoachChrisCRC/linkscard/refs/heads/main/UNCNVNTNL-Logo.png",
            "https://raw.githubusercontent.com/CoachChrisCRC/app/df3580c5a17d646dc6813a283f7e85e269fece8e/CoachChrisCRC-AppIcon.png"
        ];

        const splash = document.getElementById('splash-screen');
        const transitionScreen = document.getElementById('transition-screen');
        const mainCard = document.getElementById('main-card');
        const qrModal = document.getElementById('qr-modal');
        const openQrBtn = document.getElementById('open-qr');
        const saveVcardBtn = document.getElementById('save-vcard');
        const closeQrBtn = document.getElementById('close-qr');
        const handle = document.getElementById('swipe-handle');
        const swipeText = document.getElementById('swipe-text');
        const flipper = document.getElementById('avatar-flipper');
        const frontImg = document.getElementById('avatar-front');
        const fabSave = document.getElementById('fab-save');
        const saveUiContainer = document.getElementById('save-ui-container');

        let deferredPrompt;

        // PWA Handling
        const isStandalone = window.matchMedia('(display-mode: standalone)').matches || window.navigator.standalone === true;
        window.addEventListener('beforeinstallprompt', (e) => {
            e.preventDefault();
            deferredPrompt = e;
            if (!isStandalone) saveUiContainer.style.display = 'flex';
        });

        async function runAvatarSequence() {
            setTimeout(() => flipper.style.transform = 'rotateY(180deg)', 800);
            setTimeout(() => {
                frontImg.src = LOGOS[2];
                flipper.style.transform = 'rotateY(360deg)';
            }, 1800);
        }

        function revealDashboard() {
            splash.classList.add('fade-out');
            setTimeout(() => {
                mainCard.classList.remove('opacity-0', 'translate-y-12');
                runAvatarSequence();
            }, 200);
        }

        window.addEventListener('load', () => setTimeout(revealDashboard, 2000));

        // Generate vCard with multiple website links
        saveVcardBtn.addEventListener('click', () => {
            const vcard = [
                "BEGIN:VCARD",
                "VERSION:3.0",
                `FN:${CONTACT_INFO.name}`,
                `EMAIL;TYPE=PREF,INTERNET:${CONTACT_INFO.email}`,
                `URL;TYPE=WORK:${CONTACT_INFO.web}`,
                `URL;TYPE=INSTAGRAM:https://instagram.com/${CONTACT_INFO.instagram}`,
                `URL;TYPE=WHATSAPP:https://wa.me/${CONTACT_INFO.phone}`,
                "END:VCARD"
            ].join("\n");

            const blob = new Blob([vcard], { type: "text/vcard" });
            const url = window.URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.style.display = 'none';
            a.href = url;
            a.download = 'CoachChris.vcf';
            document.body.appendChild(a);
            a.click();
            window.URL.revokeObjectURL(url);
        });

        fabSave.addEventListener('click', async () => {
            if (deferredPrompt) {
                deferredPrompt.prompt();
                const { outcome } = await deferredPrompt.userChoice;
                if (outcome === 'accepted') saveUiContainer.style.display = 'none';
                deferredPrompt = null;
            }
        });

        // Swipe Mechanic
        let isDragging = false;
        let startX = 0;

        function onStart(e) {
            isDragging = true;
            startX = (e.type === 'touchstart') ? e.touches[0].clientX : e.clientX;
            handle.style.transition = 'none';
        }

        function onMove(e) {
            if (!isDragging) return;
            const currentX = (e.type === 'touchmove') ? e.touches[0].clientX : e.clientX;
            let delta = currentX - startX;
            const trackWidth = document.querySelector('.swipe-track').offsetWidth;
            const maxDelta = trackWidth - 56 - 12;
            delta = Math.max(0, Math.min(delta, maxDelta));
            handle.style.transform = `translateX(${delta}px)`;
            swipeText.style.opacity = 1 - (delta / maxDelta);
        }

        function resetSwipe() {
            handle.style.transition = 'transform 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275)';
            handle.style.transform = `translateX(0px)`;
            swipeText.style.opacity = 1;
            transitionScreen.classList.remove('active');
        }

        function onEnd() {
            if (!isDragging) return;
            isDragging = false;
            const matrix = new WebKitCSSMatrix(window.getComputedStyle(handle).transform);
            const trackWidth = document.querySelector('.swipe-track').offsetWidth;
            const maxDelta = trackWidth - 56 - 12;
            
            if (matrix.m41 >= maxDelta * 0.9) {
                handle.style.transition = 'transform 0.2s ease-out';
                handle.style.transform = `translateX(${maxDelta}px)`;
                transitionScreen.classList.add('active');
                setTimeout(() => {
                    window.location.href = EXTERNAL_URL;
                    setTimeout(resetSwipe, 500);
                }, 800);
            } else {
                resetSwipe();
            }
        }

        handle.addEventListener('mousedown', onStart);
        handle.addEventListener('touchstart', onStart, { passive: true });
        window.addEventListener('mousemove', onMove);
        window.addEventListener('touchmove', onMove, { passive: false });
        window.addEventListener('mouseup', onEnd);
        window.addEventListener('touchend', onEnd);

        lucide.createIcons();
        openQrBtn.addEventListener('click', () => qrModal.classList.add('active'));
        closeQrBtn.addEventListener('click', () => qrModal.classList.remove('active'));

        new QRCode(document.getElementById("qrcode"), {
            text: window.location.href,
            width: 240,
            height: 240,
            colorDark : "#000000",
            colorLight : "#ffffff",
            correctLevel : QRCode.CorrectLevel.H
        });
    </script>
</body>
</html>

